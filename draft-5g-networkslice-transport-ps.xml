<?xml version="1.0" encoding="US-ASCII"?>


<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced.
     An alternate method (rfc include) is described in the references.
-->
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs),
      please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->


<rfc category="info" docName="draft-mink-5g-ns-transport-analysis-00">
  <!-- ***** FRONT MATTER ***** -->
  <front>
    <title abbrev="draft-mink-5g-ns-transport-analysis-00">
      Analysis on Traffic Engineering for 5G Network Slicing
    </title>

    <author fullname="Tomonobu Niwa" initials="T." surname="Niwa">
      <organization>KDDI</organization>
      <address>
        <postal>
          <street>3-22-7, Yoyogi, Shibuya-ku</street>
          <city>Tokyo</city>
          <region/>
          <code>151-0053</code>
          <country>JP</country>
        </postal>
        <email>to-niwa@kddi.com</email>
      </address>
    </author>

    <author fullname="Kenji Kumaki" initials="K." surname="Kumaki">
      <organization>KDDI</organization>
      <address>
        <postal>
          <street>3-22-7, Yoyogi, Shibuya-ku</street>
          <city>Tokyo</city>
          <region/>
          <code>151-0053</code>
          <country>JP</country>
        </postal>
        <email>ke-kumaki@kddi.com</email>
      </address>
    </author>

    <author fullname="Takuya Miyasaka" initials="T." surname="Miyasaka">
      <organization>KDDI Research</organization>
      <address>
        <postal>
          <street>2-1-15, Ohara, Fujimino-shi</street>
          <city>Saitama</city>
          <region/>
          <code>356-8502</code>
          <country>JP</country>
        </postal>
        <email>ta-miyasaka@kddi-research.jp</email>
      </address>
    </author>



    <!-- TO BE FIXED -->
    <date day="31" month="October" year="2018"/>

    <area></area>

    <workgroup></workgroup>

    <keyword>I-D</keyword>

    <abstract>
      <t>
        This document describes analysis on traffic engineering for 5G Network Slicing that is expected to flexibly and dynamically fit various requrements, e.g. larger bandwidth, reliable and lower latency, and massive number of communications. 3GPP has introduced the Network Slicing concept in 5G architecture (3GPP Release 15), however, it mainly focused on mobile domains (i.e. 5G RAN and 5G Core). In order to meet the requrements, the Network Slicing needs to be designed and operated across multiple network domains including underlying IP transport network. This document analyzes current 3GPP 5G Network Slicing architecture, summarizes the requirements for interworking between the Network Slicing and the transport network, and show use cases of traffic engineerig for the interworking.
      </t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>
        A Network Slicing(NS) is expected to cater to much greater diversity of requirements for wide variety of services such as V2X services and factory automations. For the sake of optimized networks to serve these service characteristics, 3GPP is leading a NS concept in 5G system (3GPP Release 15). 3GPP NS is defined as a logical network that provides specific network capabilities and network characteristics, while it covers limited domains and mainly focuses on an isolation for 5G network function instances.
      </t>
      <t>
        The actual value of NS can be acquired when it is designed and operated from end-to-end(E2E) perspectives since the service is formed by not only 3GPP part but non-3GPP parts including transport networks. Here, the E2E means all network domains where the NS penetrates. Network operators anticipate that the introduction of NS technology is possible to tailor their networks to fit for service-oriented demands in a timely and cost-effective way with logical resource isolation, which in turn reduces OPEX and CAPEX.
      </t>
      <t>
        The document concentrates on traffic engineering of transport network for 5G NS. There are much various characteristics required by 5G NS such as larger bandwidth and reriable low delay. Hence, transport networks  supporting 5G NS should be sliced as well accoding to the characteristics of 5G NS. As for transport networks, the interworking with 5G NS can be classified into two parts: inside and outside 5G Core(5GC) network. Inside 5GC network, a network session among UE, RAN, UPF and DN belongs to a NS with one or more QoS Flow rules, and thus its underlying transport network should perform traffic enginnering along with the requrements on the NS. Outside 5GC network, a traffic path on transport network should be tied up with that on ingress/egress NS on 5GC network to guarantee quality of E2E services.
      </t>
      <t>
        This document analyzes current 5G NS architecture discussed in 3GPP, summarizes requirments for interworking between the 5G NS and transport networks, and then describes use cases of traffic engineering on transport networks applicable to the interworking.
      </t>
      <section title="Scope of this document">
        <t>
          The scope of this document is to analyze interworking between 5G NS and transport networks and show use cases of traffic engineerig for the interworking. <xref target="fig_int_ns_te" /> illustrates an E2E communication between UE and CP(Content Provider Server) on 5G NS environment.
        </t>
        <t>
          There are two different transport networks in <xref target="fig_int_ns_te" />: the transport network inside 5GC network consists of set of routers [R1, R2, R3, R4] and the transport network outside 5GC consists of [R5, R6, R7, R8]. Both inside and outside networks are within the scope of this document.
        </t>
        <figure anchor="fig_int_ns_te" title="E2E communication between UE and CP">
            <artwork align="center"><![CDATA[
      + - - - - - - - - - - - - - - - - - - +
      |  Network Slice Instance (NSI1)      |
+--+  | +---+         +---+          +---+  |
|UE+----+RAN|         |UPF+----------+DN |  |
+--+  | +-+-+         +-+-+          +-+-+  |
      + - | - - - - - - | - - - - - - -| - -+
          |             |              |
    + - - | - - - - - - |- - +   + - - | - - - - - - - - - +
    |     |             |    |   |     |                   |
          |   +----+    |              |    +----+
    |     |   | R2 |    |    |   |     |    | R6 |         |
          |   +----+    |              |    +----+
    |     |  /      \   |    |   |     |   /      \        |
       +--+-+         +-+--+         +-+--+         +----+     +--+
    |  | R1 |         | R4 | |   |   | R5 |         | R8 +-----+CP|
       +--+-+         +-+--+         +-+--+         +----+     +--+
    |     |  \      /   |    |   |     |   \      /        |
          |   +----+    |              |    +----+
    |     |   | R3 |    |    |   |     |    | R7 |         |
          |   +----+    |              |    +----+
    |     |  Transport  |    |   |     |  Transport        |
          |  Network    |              |  Network
    |     |  inside 5GC |    |   |     |  outside 5GC      |
    + - - | - - - - - - |- - +   + - - | - - - - - - - - - +
          |             |              |
      + - | - - - - - - |- - - - - - - | - +
+--+  | +-+-+         +-+-+          +-+-+ |
|UE+----+RAN|         |UPF+----------+DN | |
+--+  | +---+         +---+          +---+ |
      |  Network Slice Instance (NSI2)     |
      + - - - - - - - - - - - - - - - - - -+
]]></artwork>
          </figure>
      </section>
      <section title="Terminology">
        <t>
          <list style="symbols">
            <t>
              NS (Network Slice/Network Slicing)
            </t>
          </list>
          A Network Slice or Network Slicing is defined as "a logical network that provides specific network capabilities and network characteristics" in <xref target="TS.23.501-3GPP" />. It is managed whithin a PLMN(Public Land Mobile Network) and includes network functions for core network control plane and user plane.
        </t>
        <t>
          <list style="symbols">
            <t>
              NSI (Network Slice Instance)
            </t>
          </list>
          Network Slice Instance is defined as "a set of network function instances and the required resources (e.g. compute, storage and networking resources) which form a deployed NS" in <xref target="TS.23.501-3GPP" />.
        </t>
        <t>
          <list style="symbols">
            <t>
              Transport network
            </t>
          </list>
          The definition of transport network in this document is a network which provides network connectivity to 5G network functions such as UPF(User Plane Function). The scope of transport network in this document is limited to layer-3 network, thus IPv4 and IPv6 since 3GPP adopted IPv4/IPv6 as a 5G user plane. In particular, this document focuses on traffic engineering for NS.
        </t>
        <t>
          <list style="symbols">
            <t>
              TE (Traffic engineering)
            </t>
          </list>
          The definition of traffic engineering in this document is to control the traffic path of IPv4/IPv6 packet in order to fulfill requirements of NS, e.g. bandwidth and latency.
        </t>
        <t>
           In <xref target="fig_int_ns_te" />, there are two NSIs: NSI1 and NSI2. Suppose NSI1 provides a latency sensitive service such as V2X (in this case, UE is an automotive vehicle and CP is a control/monitoring server operated by a car vendor), an operator needs to perform traffic engineering in transport network to select a path so that total latency between UE and CP can be minimized. When one-way latency is measured as follows:
          <list style="symbols">
            <t>R1->R2->R4 : 1 msec.</t>
            <t>R1->R3->R4 : 2 msec.</t>
            <t>R5->R6->R8 : 9 msec.</t>
            <t>R5->R7->R8 : 6 msec.</t>
          </list>
          For an example of NSI1, the traffic path of inside 5GC network is R1->R2->R4 and that of outside 5GC network is R5->R7->R8. Therefore, the E2E traffic path passing through NSI1 with minimal latency is "UE->RAN->R1->R2->R4->UPF->DN->R5->R7->R8->CP."
        </t>
        <t>
          <list style="symbols">
            <t>
              Interworking
            </t>
          </list>
          The definition of interworking in this document is a method to collaborate NSIs with transport networks on performing the traffic engineering which fulfills requirements of NS.
        </t>
        <t>
          <list style="symbols">
            <t>
              NSSAI (Network Slice Selection Assistance Information)
            </t>
          </list>
          NSSAI is a collection of Single NSSAIs(S-NSSAIs) and may be a Configured NSSAI, a Requested NSSAI or an Allowed NSSAI. S-NSSAI is componsed of a SST(Slice/Service Type) and SD(Slice Differentiator) which helps to identify a NSI which a UE associated with. SST refers to the expected NS behaviour in terms of features and services. SD is optional information that complements the SST to differentiate among multiple NSs of the same SST, e.g. in case of NS for same low latency services but different companies.
        </t>
        <t>
          <list style="symbols">
            <t>
              Requrested NSSAI
            </t>
          </list>
          Requested NSSAI is provided by a UE to a PLMN during registration, allowing to the network to select the serving AMF, NS and NSI for the UE. S-NSSAIs in Requested NSSAI are part of Allowed NSSAI and/or Configured NSSAI applicable for the PLMN. If no Configured NSSAI and Allowed NSSAI for the PLMN are available, the S-NSSAIs in the Requested NSSAI correspond to the Default Configured NSSAI.
        </t>
        <t>
          <list style="symbols">
            <t>
              Allowed NSSAI
            </t>
          </list>
          Allowed NSSAI is provided by the serving PLMN to UE during e.g. registration procedure, indicating the S-NSSAIs the UE could use in the serving PLMN for the current registration area and access type.
        </t>
        <t>
          <list style="symbols">
            <t>
              Configured NSSAI
            </t>
          </list>
          Configured NSSAI may either be configured by a serving PLMN and apply to the serving PLMN, or be pre-configured by the HPLMN as a Default Configured NSSAI and apply to any PLMNs. There is at most one Configured NSSAI per a PLMN.
        </t>
        <t>
          <list style="symbols">
            <t>
              UPF (User Plane Function)
            </t>
          </list>
          UPF handles the user plane path of PDU sessions including packet routing and forwarding and QoS enforcement. Deployment with a single UPF or multiple UPFs are supported for a PDU session. The selection of UPF attached to PDU session is performed by SMF.
        </t>
        <t>
          <list style="symbols">
            <t>
              SMF (Session Management Function)
            </t>
          </list>
          SMF provides session management, UE IP address allocation, selection and control of UPF, control and coordination of charging data collection at UPF, etc.
        </t>
        <t>
          <list style="symbols">
            <t>
              AMF (Access and Mobility Management Function)
            </t>
          </list>
          AMF provides Registration management, Connection management, Reachability management and Mobility Management.
        </t>
        <t>
          <list style="symbols">
            <t>
              DNN (Data Network Name)
            </t>
          </list>
          Data Network(DN) is, for example, operator services, Internet access or 3rd party services. DN is identified by DNN which is equivalent to an APN. DNN may also be used for selecting SMF and UPFs for a PDU session. 
        </t>
        <t>
          <list style="symbols">
            <t>
              NSSF (Network Slice Selectoin Function)
            </t>
          </list>
          NSSF supports select the set of NSI serving the UE, determine the Allowed NSSAI and determinie the AMF set to be used to serve the UE.
        </t>
        <t>
          <list style="symbols">
            <t>
              NRF (Network Repository Function)
            </t>
          </list>
          NRF maintains the network function profile including network function instance ID, NS related Identifiers(e.g. S-NSSAI, NSI ID), capacity information of network functions, and so forth.
        </t>
      </section>
    </section>
    <section title="Network Slicing in 3GPP">
      <section title="Procedure of Provisioning Network Slicing">
        <t>
          <xref target="fig_5g_arch" /> shows a 5G system architecture. A NSI includes network functions for control plane(e.g. SMF) and user plane(e.g. UPF). Normally, the selection of NSI for a UE consists of two steps: serving AMF selection and NSI selection.
        </t>
        <figure anchor="fig_5g_arch" title="Service-based architecture for Network Slicing">
            <artwork align="center"><![CDATA[
     +------+ +-----+
     | NSSF | | NRF | . . . . . . . .
     +--+---+ +--+--+   
        |        | 
    ----+--+-----+----------+-----------
           |                |
        +--+--+          +--+--+
        | AMF |          | SMF |
        +--++-+          +--++-+          Cotrol Plane
          / |               | \       Network Function
 - - - - / -| - - - - - - - | -\ - - - - - - - - - - -
        /   |               |   \           User Plane
       /    |               |    \    Network Function
      /     |               |     \
+----+     ++----+     +----++     +-----+     +----+
| UE +-----+ RAN +-----+ UPF +-----+ UPF +-----+ DN |
+----+     +-----+     +-----+     +-----+     +----+
]]></artwork>
        </figure>
        <t>
          <list style="symbols">
            <t>
              Serving AMF selection
            </t>
          </list>
        </t>
        <t>
          The typical procedure of AMF selection is below:
        </t>
        <t>
          UE -> RAN: When a UE is performing an Initial Registration to a PLMN, the UE provides Registration Request to RAN with S-NSSAIs in the Requested NSSAI. S-NSSAIs in Requested NSSAI are part of Configured NSSAI and/or Allowed NSSAI based on radio access technology, when they are available. If not, Requested NSSAI is correspond to the Default Configured NSSAI which is pre-configured by the Home PLMN.
        </t>
        <t>
          RAN -> AMF: RAN routes the Registration Request to a suitable AMF based on the Requested NSSAI. If the RAN is unable to select an appropriate AMF, it forwards the Registration Request to one of the default AMFs which is selected by RAN. When the AMF selected by RAN receives the Registration Request, the AMF may retrieve UE subscription information including the Subscribed S-NSSAIs, verify whether the S-NSSAIs in the Requested NSSAI are permitted based on the Subscribed S-NSSAIs, and determine whether the AMF can serve the UE, by querying the NSSF (Network Slice Selection Function) if necessary.
        </t>
        <t>
          AMF -> UE: The Allowed NSSAI is then composed of the list of S-NSSAIs in the Requested NSSAI permitted based on the Subscribed S-NSSAIs, typically. Then, the AMF determines a Registration Area so that all S-NSSAIs of the Allowed NSSAI for this Registration Area are available in all Tracking Areas of the Registration Area and then return to the UE this Allowed NSSAI. 
        </t>
        <t>
          <list style="symbols">
            <t>
              NSI selection
            </t>
          </list>
        </t>
        <t>
          In the PDU Session Establishment procedure, network function instances in NSI are selected by the AMF. When the UE triggers PDU Session Establishment, the AMF queries the NSSF in serving PLMN with the S-NSSAI from the Allowed NSSAI requested by the UE. Then, the NSSF selects the NSI, determines and returns the appropriate NRF(Network Repository Function) to be used to select network functions within the selected NSI, and optionally may return a NSI ID corresponding to the NSI. 
          The AMF queries the appropriate NRF to select an SMF in a NSI based on S-NSSAI, DNN, NSI-ID (if available) and other information e.g. UE subscription and local operator policies. Then, the AMF sends the S-NSSAI from the Allowed NSSAI to the selected SMF.
        </t>
        <t>
          The selected SMF establishes a PDU session. The SMF selects one or more UPFs as needed and allocates an IP address/prefix for the PDU session in case of PDU Session Type IPv4 or IPv6 or IPv4v6. The SMF may be locally configured with the information about the available UPFs. As a option, the UPF selection functionality in the SMF may also utilize the NRF to discover UPF instance(s). In this case, the SMF issues a request to the NRF and retrieve the UPF Provisioning Information consists of a list of (S-NSSAI, DNN) and of a SMF Area Identity which the UPF can serve. As a result of the NSI selection, the PDU session can be established.
        </t>
      </section>
      <section title="Requrements of 5G Network Slicing">
        <t>
          In <xref target="TS.22.261-3GPP" />, basic capabilties of NS are defined as follows:
        </t>
        <t>
          <list style="symbols">
            <t>
              Operation
            </t>
          </list>
          Operators enable to create, modify including scale up/down of its capability, and delete a NS which can support the set of services and capabilities. A UE can be served by more than one NS simultaneously.
        </t>
        <t>
          <list style="symbols">
            <t>
              Mobility Support
            </t>
          </list>
          Operators enable to assign a UE to a NS, to move a UE from one NS to another, and to remove a UE from a NS ,based on subscription, UE capabilities, the access technology being used by the UE, policies and services provided by the NS.
        </t>
        <t>
          <list style="symbols">
            <t>
              Isolation
            </t>
          </list>
          Traffic and services in one NS should have no impact on those in other NS in the same network. In addition, some operations such as creation, modification and deletion of a NS should have no or minimal impact on traffic and services in other NS in the same network.
        </t>
        <t>
          In <xref target="TS.23.501-3GPP" /> and <xref target="TS.23.502-3GPP" />, inclusion relations of NS is described as follows.
        </t>
        <t>
          <list style="symbols">
            <t>
              UE vs. NSI
            </t>
          </list>
            The network may serve a single UE with one or more NSI simultaneously. Number of simultaneous connection of NSs per UE is limited by the number of S-NSSAIs in the Requested/Allowed NSSAI.
        </t>
        <t>
          <list style="symbols">
            <t>
              S-NSSAI vs. NSI
            </t>
          </list>
            Based on the operator's policy or deployment needs, a NSI can be associated with one or more S-NSSAIs, and an S-NSSAI can be associated with one or more NSI. When an S-NSSAI is associated with more than one NSI, one of these NSIs serves a UE that is allowed to use this S-NSSAI. 
        </t>
        <t>
          <list style="symbols">
            <t>
              PDU session vs. NSI
            </t>
          </list>
            A PDU session belongs to one and only one specific NSI per PLMN. Different NSIs do not share a PDU session, though different NS may have slice-specific PDU sessions using the same DNN.
        </t>
        <t>
          In sum, each PDU session is establised on one and only one NSI while the NSI can be associated with one or more S-NSSAIs. The nature should be considered for traffic engineering on transport networks.
        </t>
      </section>
    </section>

    <section title="Network Slicing in Transport Network">
      <section title="Transport Network for End-to-End 5G Communication">
        <t>
          5G NS should be isolated and can be dynamically deployed in association with UE mobility, service provisioning and capabilities required by the service. The selection of UPF for a PDU session is determined by SMF based on S-NSSAI (and DNN). For E2E perspective, transport network should follow requrements on NS; network connectivity among network functions in NSI, UE and CP servers should meet link requrements such as delay, jitter, bandwidth and so forth. The transport networks are classifled two parts: inside and outside 5GC network as <xref target="fig_int_ns_te" />.
        </t>
        <section title="Transport Network inside 5G Core Network">
          <t>
            Regarding transport connectivity between different network functions in NSI, link requirements of NS should be supported. A PDU session belongs to one and only one specific NSI in 5GC network. 5G QoS model is based on QoS Flows that is the finest granularity of QoS differentiation in the PDU session. QoS Flow is characterised by QoS profile for RAN, QoS rules for UE and PDR(Packet Detection Rule) in UPF. For transport network perspective, DSCP can be optinally utilized to support QoS Flow, however, the QoS Flow does not exactly correspond to the NS one by one. In other words, same DSCP value may be shared with multiple S-NSSAIs. Therefore, a NS can not be identified by transport networks. 
          </t>
        </section>
        <section title="Transport Network outside 5G Core Network">
          <t>
            The S-NSSAI instructs which a PDU session associates with NSI. In the current 3GPP specification, transport networks cannot recognize S-NSSAI and/or NSI ID directory from data packet itself, and thus cannot map NS inside 5GC network to traffic path on outside transport networks. Therefore, the method to interwork between 5GC network and transport network is required.
          </t>
        </section>
        <section title="Management and Orchestration of 5G Network Slicing" anchor="sec_manage_system">
          <t>
            The management and orchestration of 5G NS is studied in 3GPP SA5. This study includes creation, modification, and elimination of NSI from 3GPP management system.
          </t>
          <t>
            In this 3GPP management system, the coordination with management system of non-3GPP parts also has been taken into account and transport network management is included in the scope of the management system. <xref target="fig_coordination_tn" /> shows a concept of 3GPP management system and coordination with transport network management system, which is described in <xref target="TS.28.530-3GPP" /> and <xref target="TR.28.801-3GPP"/>. However, detailed analysis for the coordination with a transport network management system is not studied.
          </t>
          <figure anchor="fig_coordination_tn" title="E2E communication between UE and CP">
            <artwork align="center"><![CDATA[

                  +------------------------+
                  | 3GPP Management System |
                  +------------------------+
                             /|\
                              |
                              |
                             \|/
                    +-------------------+
                    | Transport Network |
                    | Management System |
                    +-------------------+
                      /|\    /|\    /|\
                       |      |      |
            +----------+      |      +------------+
            |                 |                   |
           \|/               \|/                 \|/
+---+     ----     +---+     ----     +---+     ----     +----------+
|RAN|----( TN )----|UPF|----( TN )----|DN |----( TN )----|App Server|
+---+     ----     +---+     ----     +---+     ----     +----------+

              * TN = Transport Network
              * App Server is equivalent with Content Provider Server
]]></artwork>
          </figure>
        </section>
      </section>
    </section>

    <section title="Requirements for Traffic Engineering in 5G Network Slicing Transport Network">
      <section title="Referenced Framework for Analysis">
        <t>
          We will use <xref target="reference_framework" /> as reference framework for our analysis.
          We don't intend to introduce or propose any new framework.
          We just details transport network of <xref target="fig_coordination_tn" /> and objective of this framework
          is to introduce common terminology for explanation purpose at following sections
          which describes requirements and use cases for traffic engineering in 5G network slicing
          transport network.
        </t>
        <t>
          Following terminology will be used at following sections.
          <list style="symbols">
            <t>
              3GPP Management System : A management system which requests traffic engineering policy toward transport network between given 5G functions.
            </t>
            <t>
              Transport Network Management System : A management system which provisions adequate traffic engineering policy toward PE and P routers.
            </t>
            <t>
              PE router : A router which receives IP packet from 5G function and performs provisioned traffic engineering policy on the packet.
            </t>
            <t>
              P router : A router which receives IP packet from PE router and performs provisioned traffic engineering policy on the packet.
            </t>
            <t>
              5G function : A 3GPP defined functions which provides data plane functionality in 5GC (RAN, UPF, and DN)
            </t>
          </list>
        </t>
        <figure anchor="reference_framework" title="Reference Framework for Analysis">
            <artwork align="center"><![CDATA[
               +------------------------+
               | 3GPP Management System |
               +------------------------+
                          /|\
                           |
                          \|/
                 +-------------------+
                 | Transport Network |
                 | Management System |
                 +-------------------+
                          /|\
             ______________|______________
            |         |         |         |
           \|/       \|/       \|/       \|/
+----+    +----+    +----+    +----+    +----+    +----+
|5G  |____| PE |____| P  |____| P  |____| PE |____|5G  |
|func|    |    | - -|    | - -|    | - -|    |    |func|
+----+    +----+    +----+    +----+    +----+    +----+
   |      /       Transport Network         \        |
   |     (_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _)       |
   |                                                 |
   |<- - - - - - - - - - - - - - - - - - - - - - - ->|
   |  IP reachability provided by transport network  |
]]></artwork>
        </figure>
      </section>
      <section title="Restrictions">
        <t>
          We assume following restrictions for our analysys on requirement and use case section.
          <list style="symbols">
            <t>
              5G function doesn't include any 5G Network Slicing information(e.g., S-NSSAI and NSI ID) on transmitted IP packet.
              Currently <xref target="TS.29.281-3GPP" /> doesn't provides any GTP-U extension header which includes S-NSSAI or NSI ID.
            </t>
            <t>
              5G function doesn't performs any traffic engineering operation(e.g., pushing MPLS-TE label on packet) for its attached transport network.
              Currently 5G architecture document <xref target="TS.23.501-3GPP" /> doesn't specify any traffic engineering functionality on 5G functions.
            </t>
          </list>
        </t>
      </section>
      <section title="Requirements">
        <t>
          TBD
        </t>
      </section>
    </section>

    <section title="Usecase">
      <t>
        TBD
      </t>
    </section>

    <section title="Use Case for Interworking between 3GPP and Transport Network" anchor="sec_procedure">
    <!-- Proposal: Separete Use cases: session-based and NSI-based traffic engineering-->
      <t>
        <xref target="fig_NS_interwork_arch" /> illustrates a general procedure for an interworking between 5G NS and Transport Network Traffic Engineering. We use following terminology in this figure.
        <list style="symbols">
          <t>
            5G User Plane Function : A function which is related to 5G user plane. RAN, UPF, and DN are current 5G User Plane Fucntion defined by 3GPP.
          </t>
          <t>
            NS Forwarding Policy DB : A database which maintains a forwarding policy which needs to be applied to each NS.
          </t>
          <t>
            TE Indicator : An indicator which instructs an adequate forwarding policy to router for the NS instance and encoded in an incoming packet. MPLS label and SRv6 SRH are an example for TE indicator.
          </t>
          <t>
            5G IP Packet : An IPv4/IPv6 packet sents from 5G network function.
          </t>
        </list>
      </t>

      <t>
        The 5G network function performs the following procedures for an interworking.
        <list style="numbers">
          <t>
            Recognize the NSI ID of an outgoing packet at 5G User Plane Function
          </t>
          <t>
            Decide an adequate forwarding policy which is performed on this network slice instance by inquiring to the NS Forwarding Policy DB.
          </t>
          <t>
            Encapsulate an outgoing 5G IP Packet with an adequate TE indicator for the forwarding policy of a network slice instance
          </t>
          <t>
            Send the encapsulated packet to the transport network
          </t>
        </list>
      </t>
      <figure anchor="fig_NS_interwork_arch" title="Interworking Procedure">
        <artwork align="center"><![CDATA[
5G Network Function
+-----------------+
|+---------------+|
|| NS Forwarding ||
|| Policy DB     ||
|+---------------+|
|   /|\    |      |
|    |     |      |
|    |     |      |
|    |    \|/     |
| +-------------+ |
| |5G User Plane| |
| |  Function   | | +------------+                  +------------+
| +-------------+ | |TE Indicator|                  |TE Indicator|
|       |         | +------------+      Router      +------------+
|      \|/        | |5G IP Packet| +--------------+ |5G IP Packet|
|  +----------+   | +------------+ | +----------+ | +------------+
|  |Data Plane|---+----------------+>|Data Plane|-|-------------->
|  +----------+   |                | +----------+ |    Next Router
+-----------------+                +--------------+
]]></artwork>
      </figure>
      <t>
        <xref target="fig_NS_interwork_arch_example" /> shows an example of interworking procedure.
        In this example, the 5G network function uses MPLS-TE for traffic engineering in transport network and encapsulated with MPLS label which represents an adequate MPLS-TE tunnel which fulfills requirements of a network slice instance.
        The following list describes the detailed procedure in this example.
        <list style="numbers">
          <t>
            5G Network Function recognizes that the NSI ID of the outgoing packet is 123
          </t>
          <t>
            5G Network Function resolves the required traffic engineering policy is the MPLS-TE tunnel 123 for the network slice instance
          </t>
          <t>
            5G Network Function encapsulated the outgoing 5G IP packet with MPLS label of 123 which is the outgoing label of the MPLS-TE tunnel 123
          </t>
          <t>
            5G Network Function sends the encapsulated packet to the transport network
          </t>
        </list>

      </t>
      <figure anchor="fig_NS_interwork_arch_example" title="Example of Interworking Procedure">
      <artwork align="center"><![CDATA[
 5G Network Function
+-------------------+
|+-----------------+|
|| NS Forwarding   ||
|| Policy DB       ||
||                 ||
||NSI ID:Policy    ||
||   111:MPLS-TE   ||
||       tunnel 111||
||       (HighBW)  ||
||   123:MPLS-TE   ||
||       tunnel 123||
||     (LowLatency)||
|+-----------------+|
|   /|\    |        |
|    |     |        |
|    |     |        |
| +-------------+   | +------------+                  +------------+
| |5G User Plane|   | | MPLS label |                  | MPLS label |
| |  Function   |   | |    123     |                  |    234     |
| +-------------+   | |(tunnel 123)|                  |(tunnel 123)|
|       |           | +------------+      Router      +------------+
|      \|/          | |5G IP Packet| +--------------+ |5G IP Packet|
|  +----------+     | +------------+ | +----------+ | +------------+
|  |Data Plane|-----+----------------+>|Data Plane|-|-------------->
|  +----------+     |                | +----------+ |    Next Router
+-------------------+                +--------------+
]]></artwork>
      </figure>
    </section>
    <section title="Analysis on Interworking">
      <t>
        This section describes an analysis on an interworking between 5G network slicing and transport network both outside 5GC network and inside 5GC network.
      </t>
      <section title="Analysis Assumption" anchor="sec_analysis_assumption">
        <t>
          <xref target="fig_assumption_5g" /> and the following list illustrates an assumption on 5G network slicing for our analysis.
          Sharing of network function (UPF and DN) among different network slice instances is suggested in section 4.5 of <xref target="TS.28.530-3GPP" />.
          <list style="symbols">
            <t>
              UE can connect to the multiple network slice instances.
            </t>
            <t>
              RAN is a common network function to select adequate network slice instance's UPF.
            </t>
            <t>
              UPF may be shared between different network slice instances. The shared UPF has a common IP address/prefix for an endpoint.
            </t>
            <t>
              DN may be shared between different network slice instances. The shared DN has a common IP address/prefix for an endpoint.
            </t>
          </list>
        </t>
        <figure anchor="fig_assumption_5g" title="Analysis Assumption">
          <artwork align="center"><![CDATA[
                + - - - - - - - - - - - - - - - - +
                | NS1                             |
                    +-----+     +-----+     +---+
          +-----|---| UPF |-----| UPF |-----|   |-|
          |         +-----+     +-----+     |   |
          |     + - - - - - - - - - - - - - |DN | +
          |     + - - - - - - - - - - - - - |   | +
          |     | NS2                       |   | |
+--+    +-+-+                   +-----+     |   |
|UE+----+RAN+---|---------------|     |-----|   |-|
+--+    +-+-+                   |     |     +---+
          |     + - - - - - - - |     | - - - - - +
          |     + - - - - - - - | UPF | - - - - - +
          |     | NS3           |     |           |
          |         +-----+     |     |     +---+
          +-----|---| UPF |-----|     |-----|DN |-|
                    +-----+     +-----+     +---+
                + - - - - - - - - - - - - - - - - +
]]></artwork>
        </figure>
        </section>

        <section title="Analysis inside 5G Core Network">
          <t>
            This section describes an analysis on an interworking between 5G network slicing and transport network inside 5GC network based on the procedure described in <xref target="sec_procedure" />.
            Problem statement in this analysis is emphasized as [PS-Interwork-X].
          </t>
          <t>
            <list style="format [PS-Interwork-%d]:" counter="ps-interwork">
              <t>
                5G Network Function cannot recognize the NSI ID of an established PDU session. Therefore, statically configured Policy Based Routing(PBR) based traffic engineering is required.
              </t>
            </list>
            5G Network Function cannot recognize the NSI ID of an established PDU session due to the following two reasons.
            <list style="numbers">
              <t>
                From user plane perspective, the NSI ID is not encoded in any header including GTP-U extension header.
                New PDU Session Container GTP-U extension header is introduced for 5G user plane in <xref target="TS.29.281-3GPP" />, but the extension header only includes QFI information.
              </t>
              <t>
                From control plane perspective, the NSI ID is not signaled to the user plane function such as UPF.
                PFCP is extended for 5G control plane protocol in <xref target="TS.29.244-3GPP" />, however, the NSI ID is not signaled to the user plane function.
              </t>
            </list>
            For this problem statement, we have to statically configure policy based routing(PBR) based traffic engineering in 5G network function. In <xref target="fig_example_pbr" />, an example for statically configured PBR in UPFb and UPFd is described in <xref target="fig_example_pbr_rib" />.
          </t>
          <figure anchor="fig_example_pbr" title="Example for PBR based traffic engineering">
            <artwork align="center"><![CDATA[
                + - - - - - - - - - - - - - - - - - - - +
                | NSI1 (NSI ID=1)                       |
                      +------+     +------+     +-----+
          +-----|-----| UPFa |-----| UPFb |-----| DNa | |
          |           +------+     +------+     +-----+
          |     + - - - - - - - - - - - - - - - - - - - +
          |     + - - - - - - - - - - - - - - - - - - - +
          |     | NSI2 (NSI ID=2)                       |
+--+    +-+-+         +------+     +------+     +-----+
|UE+----+RAN+---|-----|      |-----|      |-----| DNb | |
+--+    +---+         |      |     |      |     +-----+
          |     + - - |      |- - -|      | - - - - - - +
          |     + - - | UPFc |- - -| UPFd | - - - - - - +
          |     |     |      |     |      |             |
          |           |      |     |      |     +-----+
          +-----|-----|      |-----|      |-----| DNc | |
                      +------+     +------+     +-----+
                | NSI3 (NSI ID=3)                       |
                + - - - - - - - - - - - - - - - - - - - +
]]></artwork>
          </figure>
          <t>
            In case of UPFd in <xref target="fig_example_pbr" />, statically configured PBR needs to include a source IP address classification because a destination IP address of next UPF (UPFc) is common as UPFc is shared between NSI2 and NSI3 as described in <xref target="sec_analysis_assumption" />.
          </t>
          <figure anchor="fig_example_pbr_rib" title="PBR based traffic engineering">
            <artwork align="center"><![CDATA[

   +------------------------------------------------------------+
   | Routing Table for UPFb                                     |
   | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -|
   | IF: Subsequent Node IP address is <IP address of UPFa>     |
   | THEN: Nexthop is <MPLS-TE tunnel 1> (for NS1)              |
   |                                                            |
   | IF: Subsequent Node IP address is <IP address of DNa>      |
   | THEN: Nexthop is <MPLS-TE tunnel 2> (for NS2)              |
   +------------------------------------------------------------+

   +------------------------------------------------------------+
   |Routing Table for UPFd                                      |
   | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -|
   | IF: Subsequent Node IP address is <IP address of UPFc>     |
   |     AND Previous Node IP address is <IP address of DNb>    |
   | THEN: Nexthop is <MPLS-TE tunnel 1> (for NS2)              |
   |                                                            |
   | IF: Subsequent Node IP address is <IP address of DNb>      |
   | THEN: Nexthop is <MPLS-TE tunnel 2> (for NS2)              |
   |                                                            |
   | IF: Subsequent Node IP address is <IP address of UPFc>     |
   |     AND Previous Node IP address is <IP address of DNc>    |
   | THEN: Nexthop is <MPLS-TE tunnel 3> (for NS3)              |
   |                                                            |
   | IF: Subsequent Node IP address is <IP address of DNc>      |
   | THEN: Nexthop is <MPLS-TE tunnel 4> (for NS3)              |
   +------------------------------------------------------------+
]]></artwork>
          </figure>
          <t>
            <list style="format [PS-Interwork-%d]:" counter="ps-interwork">
              <t>
                5G network function cannot classify a network slice instance by using PBR If both previous node and subsequent node are shared between different network slice instances.
              </t>
            </list>
          </t>
          <t>
            For example, a routing table for UPFc in <xref target="fig_example_pbr" /> toward RAN node cannot classify NS2 and NS3, because previous node is UPFb which is shared NS2 and NS3 and the subsequent node is RAN which is a common network function among network slice instances as described in <xref target="sec_analysis_assumption"/>. Therefore, the source IP address and the destination IP address are common among NS2 and NS3, so we cannot create an adequate PBR rule for each network slice instance.
          </t>
        </section>
      <section title="Analysis outside 5G Core Network">
        <t>
          TBD
        </t>

      </section>
    </section>
    <section title="Problem Statement Summary">
      <t>
        The following list summarizes problem statement for the interworking inside 5GC network.
      </t>
      <t>
        <list style="format [PS-Interwork-%d]:" counter="ps-interwork2">
          <t>
            5G Network Function cannot recognize the NSI ID of the established PDU session. Therefore, statically configured Policy Based Routing(PBR) based traffic engineering is required
          </t>
        </list>
        <list style="format [PS-Interwork-%d]:" counter="ps-interwork2">
          <t>
            5G network function cannot classify the network slice instance by using PBR If both previous node and subsequent node are shared between different network slice instances.
          </t>
        </list>
      </t>
      <t>
        The following list summarizes problem statement for the interworking outside 5GC network.
      </t>
      <t>
        <list style="format [PS-Interwork-%d]:" counter="ps-interwork2">
          <t>
            TBD
          </t>
        </list>
      </t>
    </section>

    <section title="Conclusion">
      <t>
        This document summarizes problem statements for interworking between 5G network slicing and transport network.
        Our analysis shows the traffic engineering for 5G network slicing is achieved by using policy based routing.
        However, if 5G network function, e.g., UPF, is shared among different network slice instance,
        there is a case that the traffic engineering is not achieved because the 5G network function cannot distinguish network slice instance [PS-Interwork-2].
        This issue is inevitable under current 5G specification and we need to give the feedback to 3GPP to solve the issue.
      </t>
      <t>
        From IETF point of view, "transport network management system" is required from 3GPP SA5 WG as described in <xref target="sec_manage_system"/>.
        This transport network management system needs to serve a transport network related request sent from 3GPP management system,
        this means the transport network management system needs to provide API to 3GPP management system to control transport network from 3GPP side.
        Therefore IETF needs to collaborate with 3GPP, especially for 3GPP SA5 WG, and
        examine if current standardized technology and framework in IETF activity fulfill requirements from 3GPP.
      </t>
    </section>

    <section title="Security Consideration">
    <t>TBD</t>
    </section>

    <section title="IANA Considerations">
    <t>This document does not require any action from IANA.</t>
    </section>

    <section title="Acknowledgement">
    <t>
    The author would like to thank Takeshi Usui, Satoru Matsushima, Shunsuke Homma for their useful comments.
    </t>
    </section>
  </middle>

  <!-- ***** BACK MATTER ***** -->

  <back>

<!--
    <references title="Normative References">

    &RFC2119;

    </references>
-->
    <references title="Informative References">
      <reference anchor='TS.29.244-3GPP' target="http://www.3gpp.org/ftp//Specs/archive/29_series/29.244/29244-f30.zip">
        <front>
        <title>3GPP TS 29.244 (V15.3.0): Interface between the Control Plane and the User Plane Nodes; Stage 3</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="September" year="2018"/>
        </front>
      </reference>

      <reference anchor='TS.29.281-3GPP' target="http://www.3gpp.org/ftp//Specs/archive/29_series/29.281/29281-f40.zip">
        <front>
        <title>3GPP TS 29.281 (V15.4.0): GPRS Tunneling Protocol User Plane (GTPv1-U)</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="September" year="2018"/>
        </front>
      </reference>

      <reference anchor='TS.23.501-3GPP' target="http://www.3gpp.org/ftp//Specs/archive/23_series/23.501/23501-f30.zip">
        <front>
        <title>3GPP TS 23.501 (V15.3.0): System Architecture for 5G System; Stage 2</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="September" year="2018"/>
        </front>
      </reference>

      <reference anchor='TS.28.530-3GPP'  target="http://www.3gpp.org/ftp//Specs/archive/28_series/28.530/28530-f00.zip">
        <front>
        <title>3GPP TS 28.530 (V15.0.0): Telecommunication management; Management and orchestration of networks and network slicing; Concepts, use cases and requirements</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="September" year="2018"/>
        </front>
      </reference>

      <reference anchor='TS.22.261-3GPP'  target="http://www.3gpp.org/ftp//Specs/archive/22_series/22.261/22261-f60.zip">
        <front>
        <title>3GPP TS 22.261 (V15.6.0): Service requirements for the 5G system; Stage 1</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="September" year="2018"/>
        </front>
      </reference>

      <reference anchor='TS.23.502-3GPP'  target="http://www.3gpp.org/ftp//Specs/archive/23_series/23.502/23502-f30.zip">
        <front>
        <title>3GPP TS 23.502 (V15.3.0): Procedures for the 5G System; Stage 2</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="September" year="2018"/>
        </front>
      </reference>

      <reference anchor='TR.28.801-3GPP'  target="http://www.3gpp.org/ftp//Specs/archive/28_series/28.801/28801-f10.zip">
        <front>
        <title>3GPP TR 28.801 (V15.1.0): Study on management and orchestration of network slicing for next generation network</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="January" year="2018"/>
        </front>
      </reference>
    </references>
  </back>
</rfc>